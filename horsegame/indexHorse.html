<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horse Race Game with Betting</title>
</head>
<body>

<h1>Horse Race Game with Betting</h1>

<button onclick="startRace()">Start Race</button>
<br>
<label for="betAmount">Bet Amount:</label>
<input type="number" id="betAmount">
<br>
<label for="selectedHorse">Select Horse (1-4):</label>
<input type="number" id="selectedHorse" min="1" max="4">
<button onclick="placeBet()">Place Bet</button>

<script>
    function getRandomNumber(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateTrack() {
        const start = 0;
        const end = getRandomNumber(20, 30);
        return { start, end };
    }

    function moveHorse(horse) {
        const move = getRandomNumber(0, 3);
        horse.position += move;

        if (horse.position >= horse.end) {
            horse.position = horse.end;
        }
    }

    function placeBet() {
        const betAmount = parseInt(document.getElementById("betAmount").value);
        const selectedHorse = parseInt(document.getElementById("selectedHorse").value);

        if (betAmount > 0 && selectedHorse >= 1 && selectedHorse <= 4) {
            const selectedHorseObject = horses.find(horse => horse.number === selectedHorse);
            if (selectedHorseObject) {
                person.bet = { horse: selectedHorseObject.number, amount: betAmount };
                console.log("Bet placed on Horse " + selectedHorseObject.number + " with amount: " + betAmount);
            } else {
                console.log("Invalid horse selection!");
            }
        } else {
            console.log("Invalid bet amount or horse selection!");
        }
    }

    function startRace() {
        horses.forEach(horse => horse.position = 0);
        person.bet = null;

        while (horses.some(horse => horse.position < horse.end)) {
            horses.forEach(moveHorse);

            console.log("Race update:");
            horses.forEach(horse => console.log("Horse " + horse.number + ": " + horse.position + "/" + horse.end));
        }
        const winners = horses.sort((a, b) => b.position - a.position);
        console.log("Race finished!");
        console.log("Winner: Horse " + winners[0].number);

        if (person.bet && person.bet.horse === winners[0].number) {
            const winnings = person.bet.amount * 2;
            person.currency += winnings;
            console.log("Congratulations! You won " + winnings + " currency.");
        } else {
            console.log("Better luck next time! You lost your bet of " + (person.bet ? person.bet.amount : 0) + " currency.");
        }
    }

    const horses = [
        { ...generateTrack(), number: 1, position: 0 },
        { ...generateTrack(), number: 2, position: 0 },
        { ...generateTrack(), number: 3, position: 0 },
        { ...generateTrack(), number: 4, position: 0 }
    ];

    const person = { currency: 100, bet: null };
</script>

</body>
</html>
